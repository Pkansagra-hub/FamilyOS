{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Cortex Module Event Catalog",
  "description": "Cortex events for prediction and bandit algorithms",
  "type": "object",
  "properties": {
    "events": {
      "type": "array",
      "items": [
        {
          "name": "PREDICTION_COMPUTED",
          "version": "1.0",
          "description": "Prediction result with confidence and feature contributions",
          "schema": {
            "type": "object",
            "properties": {
              "prediction_id": { "type": "string", "format": "ulid" },
              "prediction_type": { "type": "string", "enum": ["action_outcome", "retrieval_relevance", "user_intent", "resource_usage"] },
              "model_version": { "type": "string" },
              "prediction_value": { "type": "number" },
              "confidence": { "type": "number", "minimum": 0, "maximum": 1 },
              "uncertainty": { "type": "number", "minimum": 0, "maximum": 1 },
              "feature_contributions": { "type": "object", "additionalProperties": { "type": "number" } },
              "processing_time_ms": { "type": "integer", "minimum": 0 }
            },
            "required": ["prediction_id", "prediction_type", "model_version", "prediction_value", "confidence"]
          },
          "key": { "partition": "prediction_type", "ordering": "ts" },
          "idempotency": { "dedupe_key": "prediction_id", "window": "PT1M" },
          "retention": "P90D"
        },
        {
          "name": "BANDIT_UPDATE",
          "version": "1.0",
          "description": "Multi-armed bandit algorithm parameter updates",
          "schema": {
            "type": "object",
            "properties": {
              "update_id": { "type": "string", "format": "ulid" },
              "bandit_type": { "type": "string", "enum": ["ucb1", "thompson_sampling", "contextual", "multi_objective"] },
              "arm_id": { "type": "string" },
              "reward_received": { "type": "number" },
              "exploration_weight": { "type": "number", "minimum": 0, "maximum": 1 },
              "updated_parameters": { "type": "object", "additionalProperties": true },
              "cumulative_regret": { "type": "number", "minimum": 0 }
            },
            "required": ["update_id", "bandit_type", "arm_id", "reward_received"]
          },
          "key": { "partition": "bandit_type", "ordering": "ts" },
          "idempotency": { "dedupe_key": "update_id", "window": "PT30S" },
          "retention": "P60D"
        },
        {
          "name": "FEATURE_EXTRACTED",
          "version": "1.0",
          "description": "New feature vector computed for prediction models",
          "schema": {
            "type": "object",
            "properties": {
              "extraction_id": { "type": "string", "format": "ulid" },
              "feature_type": { "type": "string", "enum": ["temporal", "contextual", "behavioral", "semantic"] },
              "source_event_id": { "type": "string", "format": "ulid" },
              "feature_vector": { "type": "object", "additionalProperties": { "type": "number" } },
              "dimensionality": { "type": "integer", "minimum": 1 },
              "extraction_time_ms": { "type": "integer", "minimum": 0 },
              "quality_score": { "type": "number", "minimum": 0, "maximum": 1 }
            },
            "required": ["extraction_id", "feature_type", "source_event_id", "feature_vector"]
          },
          "key": { "partition": "feature_type", "ordering": "ts" },
          "idempotency": { "dedupe_key": "extraction_id", "window": "PT2M" },
          "retention": "P30D"
        }
      ]
    }
  }
}
