openapi: 3.1.0
info:
  title: MemoryOS Control Plane - Policy Enforcement API
  description: |
    **Memory-Centric Family AI Policy Enforcement Operations**

    This API provides family administrators with comprehensive policy enforcement capabilities:
    - **Access Control Enforcement**: Enforce family access controls, permissions, and security boundaries
    - **Privacy Policy Management**: Manage and enforce family privacy policies and data protection rules
    - **Security Policy Enforcement**: Enforce family security policies, authentication, and authorization rules
    - **Compliance Monitoring**: Monitor family policy compliance and generate compliance reports
    - **Policy Violation Management**: Detect, analyze, and remediate family policy violations

    **Memory-Centric Design**: Policy enforcement leverages Memory Backbone for:
    - Family policy understanding through memory-driven policy pattern recognition and enforcement intelligence
    - Memory-informed policy enforcement with historical policy compliance analysis and violation pattern detection
    - Cross-family policy intelligence with policy memory synthesis and compliance optimization
    - Policy evolution tracking through memory-aware policy development and enforcement adaptation

    **Architecture Integration**:
    - Integrates with Memory Backbone for memory-informed policy enforcement and compliance intelligence
    - Leverages Family Intelligence for relationship-aware policy enforcement and family boundary management
    - Coordinates with Intelligence Layer for advanced policy analytics and enforcement optimization
    - Enforces family policies through comprehensive policy engine and real-time enforcement mechanisms
  version: "1.0.0"
  contact:
    name: MemoryOS API Team
    url: https://familyos.local/support
    email: api-support@familyos.local
  license:
    name: Family OS Private License
    url: https://familyos.local/licenses/family-os

servers:
  - url: https://api.familyos.local/control/v1
    description: Production Control Plane
  - url: https://staging-api.familyos.local/control/v1
    description: Staging Environment
  - url: http://localhost:8080/control/v1
    description: Local Development

security:
  - FamilyAdminAuth: []
  - FamilyOSAuth: []

paths:
  /policies/access-control:
    get:
      summary: Get Access Control Policies
      description: |
        Retrieve comprehensive access control policies including permissions, roles, and security boundaries.

        **Access Control Management**: Get complete access control policy configuration with enforcement status.
        **Security Administration**: Retrieve access control policies with administrative context and enforcement insights.
      operationId: getAccessControlPolicies
      parameters:
        - name: policy_scope
          in: query
          description: Scope of access control policies to retrieve
          required: false
          schema:
            type: string
            enum: [family_wide, role_based, member_specific, resource_specific]
            default: family_wide
        - name: include_enforcement_status
          in: query
          description: Include policy enforcement status
          required: false
          schema:
            type: boolean
            default: true
        - name: include_violations
          in: query
          description: Include recent policy violations
          required: false
          schema:
            type: boolean
            default: false
      responses:
        '200':
          description: Access control policies retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  access_control_policies:
                    type: array
                    items:
                      $ref: '#/components/schemas/AccessControlPolicy'
                  enforcement_status:
                    $ref: '#/components/schemas/PolicyEnforcementStatus'
                  compliance_summary:
                    $ref: '#/components/schemas/AccessControlComplianceSummary'
                  policy_violations:
                    type: array
                    items:
                      $ref: '#/components/schemas/PolicyViolation'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '500':
          $ref: '#/components/responses/InternalServerError'
      tags:
        - Access Control

    post:
      summary: Create Access Control Policy
      description: |
        Create new access control policy with enforcement rules and compliance requirements.

        **Access Control Creation**: Establish new access control policy with enforcement configuration.
        **Security Policy Setup**: Create access control policy with security boundaries and permission management.
      operationId: createAccessControlPolicy
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateAccessControlPolicyRequest'
      responses:
        '201':
          description: Access control policy created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  policy_id:
                    type: string
                    format: uuid
                  access_control_policy:
                    $ref: '#/components/schemas/AccessControlPolicy'
                  enforcement_status:
                    $ref: '#/components/schemas/PolicyEnforcementStatus'
                  validation_results:
                    $ref: '#/components/schemas/PolicyValidationResults'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '500':
          $ref: '#/components/responses/InternalServerError'
      tags:
        - Access Control

  /policies/privacy:
    get:
      summary: Get Privacy Policies
      description: |
        Retrieve comprehensive privacy policies including data protection rules and privacy boundaries.

        **Privacy Policy Management**: Get complete privacy policy configuration with enforcement and compliance status.
        **Data Protection Administration**: Retrieve privacy policies with administrative context and protection insights.
      operationId: getPrivacyPolicies
      parameters:
        - name: policy_type
          in: query
          description: Type of privacy policies to retrieve
          required: false
          schema:
            type: array
            items:
              type: string
              enum: [data_collection, data_sharing, data_retention, data_access, data_deletion]
        - name: include_compliance_metrics
          in: query
          description: Include privacy compliance metrics
          required: false
          schema:
            type: boolean
            default: true
      responses:
        '200':
          description: Privacy policies retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  privacy_policies:
                    type: array
                    items:
                      $ref: '#/components/schemas/PrivacyPolicy'
                  privacy_compliance:
                    $ref: '#/components/schemas/PrivacyCompliance'
                  data_protection_status:
                    $ref: '#/components/schemas/DataProtectionStatus'
                  privacy_violations:
                    type: array
                    items:
                      $ref: '#/components/schemas/PrivacyViolation'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '500':
          $ref: '#/components/responses/InternalServerError'
      tags:
        - Privacy Policies

    post:
      summary: Create Privacy Policy
      description: |
        Create new privacy policy with data protection rules and enforcement mechanisms.

        **Privacy Policy Creation**: Establish new privacy policy with data protection configuration.
        **Data Protection Setup**: Create privacy policy with protection boundaries and compliance requirements.
      operationId: createPrivacyPolicy
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreatePrivacyPolicyRequest'
      responses:
        '201':
          description: Privacy policy created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  policy_id:
                    type: string
                    format: uuid
                  privacy_policy:
                    $ref: '#/components/schemas/PrivacyPolicy'
                  enforcement_status:
                    $ref: '#/components/schemas/PolicyEnforcementStatus'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '500':
          $ref: '#/components/responses/InternalServerError'
      tags:
        - Privacy Policies

  /policies/security:
    get:
      summary: Get Security Policies
      description: |
        Retrieve comprehensive security policies including authentication, authorization, and security controls.

        **Security Policy Management**: Get complete security policy configuration with enforcement and threat protection.
        **Security Administration**: Retrieve security policies with administrative context and protection insights.
      operationId: getSecurityPolicies
      parameters:
        - name: security_domain
          in: query
          description: Security domain for policy retrieval
          required: false
          schema:
            type: array
            items:
              type: string
              enum: [authentication, authorization, encryption, network_security, device_security]
        - name: include_threat_assessment
          in: query
          description: Include security threat assessment
          required: false
          schema:
            type: boolean
            default: false
      responses:
        '200':
          description: Security policies retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  security_policies:
                    type: array
                    items:
                      $ref: '#/components/schemas/SecurityPolicy'
                  security_compliance:
                    $ref: '#/components/schemas/SecurityCompliance'
                  threat_assessment:
                    $ref: '#/components/schemas/SecurityThreatAssessment'
                  security_violations:
                    type: array
                    items:
                      $ref: '#/components/schemas/SecurityViolation'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '500':
          $ref: '#/components/responses/InternalServerError'
      tags:
        - Security Policies

    post:
      summary: Create Security Policy
      description: |
        Create new security policy with security controls and enforcement mechanisms.

        **Security Policy Creation**: Establish new security policy with protection configuration.
        **Security Control Setup**: Create security policy with control mechanisms and threat protection.
      operationId: createSecurityPolicy
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateSecurityPolicyRequest'
      responses:
        '201':
          description: Security policy created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  policy_id:
                    type: string
                    format: uuid
                  security_policy:
                    $ref: '#/components/schemas/SecurityPolicy'
                  enforcement_status:
                    $ref: '#/components/schemas/PolicyEnforcementStatus'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '500':
          $ref: '#/components/responses/InternalServerError'
      tags:
        - Security Policies

  /policies/enforcement:
    get:
      summary: Get Policy Enforcement Status
      description: |
        Retrieve comprehensive policy enforcement status including active enforcement, compliance metrics, and violation summaries.

        **Enforcement Management**: Get complete policy enforcement status with administrative oversight.
        **Compliance Administration**: Retrieve enforcement status with compliance context and violation insights.
      operationId: getPolicyEnforcementStatus
      parameters:
        - name: enforcement_scope
          in: query
          description: Scope of enforcement status to retrieve
          required: false
          schema:
            type: string
            enum: [all_policies, policy_type_specific, critical_policies, active_violations]
            default: all_policies
        - name: time_range
          in: query
          description: Time range for enforcement metrics
          required: false
          schema:
            type: string
            enum: [last_hour, last_day, last_week, last_month]
            default: last_day
      responses:
        '200':
          description: Policy enforcement status retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  enforcement_overview:
                    $ref: '#/components/schemas/PolicyEnforcementOverview'
                  enforcement_metrics:
                    $ref: '#/components/schemas/PolicyEnforcementMetrics'
                  compliance_status:
                    $ref: '#/components/schemas/OverallComplianceStatus'
                  active_violations:
                    type: array
                    items:
                      $ref: '#/components/schemas/PolicyViolation'
                  enforcement_alerts:
                    type: array
                    items:
                      $ref: '#/components/schemas/EnforcementAlert'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '500':
          $ref: '#/components/responses/InternalServerError'
      tags:
        - Policy Enforcement

    post:
      summary: Execute Policy Enforcement Action
      description: |
        Execute specific policy enforcement action including violation remediation and compliance restoration.

        **Enforcement Action**: Execute policy enforcement action with administrative oversight.
        **Compliance Restoration**: Perform enforcement action with compliance restoration and violation remediation.
      operationId: executePolicyEnforcementAction
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExecuteEnforcementActionRequest'
      responses:
        '200':
          description: Policy enforcement action executed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  action_id:
                    type: string
                    format: uuid
                  enforcement_action:
                    $ref: '#/components/schemas/EnforcementAction'
                  execution_status:
                    $ref: '#/components/schemas/ActionExecutionStatus'
                  remediation_results:
                    $ref: '#/components/schemas/RemediationResults'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '500':
          $ref: '#/components/responses/InternalServerError'
      tags:
        - Policy Enforcement

  /policies/violations:
    get:
      summary: Get Policy Violations
      description: |
        Retrieve comprehensive policy violations including violation details, severity, and remediation status.

        **Violation Management**: Get complete policy violation information with administrative context.
        **Compliance Monitoring**: Retrieve violations with compliance impact and remediation insights.
      operationId: getPolicyViolations
      parameters:
        - name: violation_severity
          in: query
          description: Filter violations by severity level
          required: false
          schema:
            type: array
            items:
              type: string
              enum: [low, medium, high, critical]
        - name: violation_status
          in: query
          description: Filter violations by status
          required: false
          schema:
            type: array
            items:
              type: string
              enum: [open, investigating, remediating, resolved, dismissed]
        - name: policy_type
          in: query
          description: Filter violations by policy type
          required: false
          schema:
            type: array
            items:
              type: string
              enum: [access_control, privacy, security, coordination, resource_management]
        - name: time_range
          in: query
          description: Time range for violation retrieval
          required: false
          schema:
            type: string
            enum: [last_hour, last_day, last_week, last_month]
            default: last_week
      responses:
        '200':
          description: Policy violations retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  policy_violations:
                    type: array
                    items:
                      $ref: '#/components/schemas/DetailedPolicyViolation'
                  violation_statistics:
                    $ref: '#/components/schemas/ViolationStatistics'
                  compliance_impact:
                    $ref: '#/components/schemas/ComplianceImpact'
                  remediation_recommendations:
                    type: array
                    items:
                      $ref: '#/components/schemas/RemediationRecommendation'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '500':
          $ref: '#/components/responses/InternalServerError'
      tags:
        - Policy Violations

    post:
      summary: Report Policy Violation
      description: |
        Report new policy violation with violation details and impact assessment.

        **Violation Reporting**: Report policy violation with administrative processing.
        **Compliance Incident**: Report violation with compliance impact and remediation planning.
      operationId: reportPolicyViolation
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ReportPolicyViolationRequest'
      responses:
        '201':
          description: Policy violation reported successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  violation_id:
                    type: string
                    format: uuid
                  policy_violation:
                    $ref: '#/components/schemas/PolicyViolation'
                  investigation_status:
                    $ref: '#/components/schemas/ViolationInvestigationStatus'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '500':
          $ref: '#/components/responses/InternalServerError'
      tags:
        - Policy Violations

  /policies/compliance:
    get:
      summary: Get Compliance Report
      description: |
        Retrieve comprehensive compliance report including compliance metrics, trends, and recommendations.

        **Compliance Reporting**: Get complete compliance report with administrative insights.
        **Compliance Administration**: Retrieve compliance status with governance context and improvement recommendations.
      operationId: getComplianceReport
      parameters:
        - name: report_scope
          in: query
          description: Scope of compliance report
          required: false
          schema:
            type: string
            enum: [overall, policy_specific, member_specific, time_period]
            default: overall
        - name: report_period
          in: query
          description: Reporting period for compliance metrics
          required: false
          schema:
            type: string
            enum: [daily, weekly, monthly, quarterly]
            default: monthly
        - name: include_trends
          in: query
          description: Include compliance trends analysis
          required: false
          schema:
            type: boolean
            default: true
      responses:
        '200':
          description: Compliance report retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  compliance_report:
                    $ref: '#/components/schemas/ComplianceReport'
                  compliance_metrics:
                    $ref: '#/components/schemas/ComplianceMetrics'
                  compliance_trends:
                    $ref: '#/components/schemas/ComplianceTrends'
                  improvement_recommendations:
                    type: array
                    items:
                      $ref: '#/components/schemas/ComplianceImprovementRecommendation'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '500':
          $ref: '#/components/responses/InternalServerError'
      tags:
        - Compliance Monitoring

    post:
      summary: Generate Compliance Assessment
      description: |
        Generate comprehensive compliance assessment with analysis and recommendations.

        **Compliance Assessment**: Generate compliance assessment with administrative analysis.
        **Governance Assessment**: Generate assessment with governance insights and improvement strategies.
      operationId: generateComplianceAssessment
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GenerateComplianceAssessmentRequest'
      responses:
        '201':
          description: Compliance assessment generated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  assessment_id:
                    type: string
                    format: uuid
                  compliance_assessment:
                    $ref: '#/components/schemas/ComplianceAssessment'
                  assessment_status:
                    $ref: '#/components/schemas/AssessmentStatus'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '500':
          $ref: '#/components/responses/InternalServerError'
      tags:
        - Compliance Monitoring

  /policies/audit:
    get:
      summary: Get Policy Audit Trail
      description: |
        Retrieve comprehensive policy audit trail including policy changes, enforcement actions, and compliance events.

        **Audit Management**: Get complete policy audit trail with administrative oversight.
        **Governance Auditing**: Retrieve audit trail with governance context and compliance tracking.
      operationId: getPolicyAuditTrail
      parameters:
        - name: audit_scope
          in: query
          description: Scope of audit trail to retrieve
          required: false
          schema:
            type: string
            enum: [all_events, policy_changes, enforcement_actions, compliance_events]
            default: all_events
        - name: time_range
          in: query
          description: Time range for audit trail
          required: false
          schema:
            type: string
            enum: [last_day, last_week, last_month, last_quarter]
            default: last_month
        - name: include_details
          in: query
          description: Include detailed audit information
          required: false
          schema:
            type: boolean
            default: true
      responses:
        '200':
          description: Policy audit trail retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  audit_trail:
                    type: array
                    items:
                      $ref: '#/components/schemas/PolicyAuditEvent'
                  audit_summary:
                    $ref: '#/components/schemas/AuditSummary'
                  audit_insights:
                    type: array
                    items:
                      $ref: '#/components/schemas/AuditInsight'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '500':
          $ref: '#/components/responses/InternalServerError'
      tags:
        - Policy Audit

components:
  securitySchemes:
    FamilyAdminAuth:
      type: http
      scheme: bearer
      description: Family administrator JWT authentication for policy enforcement operations
      bearerFormat: JWT

    FamilyOSAuth:
      type: oauth2
      description: FamilyOS OAuth2 authentication with policy enforcement scopes
      flows:
        authorizationCode:
          authorizationUrl: https://auth.familyos.local/oauth/authorize
          tokenUrl: https://auth.familyos.local/oauth/token
          scopes:
            policies:admin: Full policy administration access
            policies:access_control: Manage access control policies
            policies:privacy: Manage privacy policies
            policies:security: Manage security policies
            policies:enforcement: Execute policy enforcement actions
            policies:violations: Manage policy violations
            policies:compliance: Access compliance reports and assessments
            policies:audit: Access policy audit trails

  schemas:
    AccessControlPolicy:
      type: object
      description: Comprehensive access control policy definition
      properties:
        policy_id:
          type: string
          format: uuid
        policy_name:
          type: string
        policy_version:
          type: string
        policy_scope:
          type: string
          enum: [family_wide, role_based, member_specific, resource_specific]
        access_rules:
          type: array
          items:
            $ref: '#/components/schemas/AccessRule'
        permission_matrix:
          $ref: '#/components/schemas/PermissionMatrix'
        enforcement_settings:
          $ref: '#/components/schemas/EnforcementSettings'
        policy_status:
          type: string
          enum: [active, inactive, pending, deprecated]
        created_date:
          type: string
          format: date-time
        last_modified:
          type: string
          format: date-time
        policy_metadata:
          type: object
      required:
        - policy_id
        - policy_name
        - policy_scope
        - policy_status

    PrivacyPolicy:
      type: object
      description: Comprehensive privacy policy definition
      properties:
        policy_id:
          type: string
          format: uuid
        policy_name:
          type: string
        privacy_type:
          type: string
          enum: [data_collection, data_sharing, data_retention, data_access, data_deletion]
        privacy_rules:
          type: array
          items:
            $ref: '#/components/schemas/PrivacyRule'
        data_protection_settings:
          $ref: '#/components/schemas/DataProtectionSettings'
        consent_requirements:
          $ref: '#/components/schemas/ConsentRequirements'
        policy_status:
          type: string
          enum: [active, inactive, pending, deprecated]
        compliance_requirements:
          type: array
          items:
            type: string
        policy_metadata:
          type: object
      required:
        - policy_id
        - policy_name
        - privacy_type
        - policy_status

    SecurityPolicy:
      type: object
      description: Comprehensive security policy definition
      properties:
        policy_id:
          type: string
          format: uuid
        policy_name:
          type: string
        security_domain:
          type: string
          enum: [authentication, authorization, encryption, network_security, device_security]
        security_controls:
          type: array
          items:
            $ref: '#/components/schemas/SecurityControl'
        threat_protection:
          $ref: '#/components/schemas/ThreatProtection'
        security_requirements:
          type: array
          items:
            type: string
        policy_status:
          type: string
          enum: [active, inactive, pending, deprecated]
        policy_metadata:
          type: object
      required:
        - policy_id
        - policy_name
        - security_domain
        - policy_status

    PolicyViolation:
      type: object
      description: Policy violation information
      properties:
        violation_id:
          type: string
          format: uuid
        policy_id:
          type: string
          format: uuid
        violation_type:
          type: string
          enum: [access_violation, privacy_violation, security_violation, compliance_violation]
        violation_severity:
          type: string
          enum: [low, medium, high, critical]
        violation_status:
          type: string
          enum: [open, investigating, remediating, resolved, dismissed]
        violation_description:
          type: string
        violation_details:
          type: object
        involved_members:
          type: array
          items:
            type: string
            format: uuid
        detection_time:
          type: string
          format: date-time
        resolution_time:
          type: string
          format: date-time
        remediation_actions:
          type: array
          items:
            $ref: '#/components/schemas/RemediationAction'
        violation_metadata:
          type: object
      required:
        - violation_id
        - policy_id
        - violation_type
        - violation_severity
        - violation_status

    CreateAccessControlPolicyRequest:
      type: object
      description: Request to create access control policy
      properties:
        policy_name:
          type: string
          maxLength: 100
        policy_scope:
          type: string
          enum: [family_wide, role_based, member_specific, resource_specific]
        access_rules:
          type: array
          items:
            $ref: '#/components/schemas/AccessRuleDefinition'
        permission_settings:
          $ref: '#/components/schemas/PermissionSettings'
        enforcement_configuration:
          $ref: '#/components/schemas/EnforcementConfiguration'
        policy_metadata:
          type: object
      required:
        - policy_name
        - policy_scope
        - access_rules

    CreatePrivacyPolicyRequest:
      type: object
      description: Request to create privacy policy
      properties:
        policy_name:
          type: string
          maxLength: 100
        privacy_type:
          type: string
          enum: [data_collection, data_sharing, data_retention, data_access, data_deletion]
        privacy_rules:
          type: array
          items:
            $ref: '#/components/schemas/PrivacyRuleDefinition'
        data_protection_configuration:
          $ref: '#/components/schemas/DataProtectionConfiguration'
        consent_configuration:
          $ref: '#/components/schemas/ConsentConfiguration'
        compliance_requirements:
          type: array
          items:
            type: string
      required:
        - policy_name
        - privacy_type
        - privacy_rules

    CreateSecurityPolicyRequest:
      type: object
      description: Request to create security policy
      properties:
        policy_name:
          type: string
          maxLength: 100
        security_domain:
          type: string
          enum: [authentication, authorization, encryption, network_security, device_security]
        security_controls:
          type: array
          items:
            $ref: '#/components/schemas/SecurityControlDefinition'
        threat_protection_configuration:
          $ref: '#/components/schemas/ThreatProtectionConfiguration'
        security_requirements:
          type: array
          items:
            type: string
      required:
        - policy_name
        - security_domain
        - security_controls

    ExecuteEnforcementActionRequest:
      type: object
      description: Request to execute policy enforcement action
      properties:
        action_type:
          type: string
          enum: [access_restriction, privilege_revocation, notification_send, violation_remediation, compliance_restoration]
        target_entities:
          type: array
          items:
            $ref: '#/components/schemas/EnforcementTarget'
        action_parameters:
          type: object
        enforcement_scope:
          type: string
          enum: [immediate, scheduled, conditional]
        action_metadata:
          type: object
      required:
        - action_type
        - target_entities

    ReportPolicyViolationRequest:
      type: object
      description: Request to report policy violation
      properties:
        policy_id:
          type: string
          format: uuid
        violation_type:
          type: string
          enum: [access_violation, privacy_violation, security_violation, compliance_violation]
        violation_severity:
          type: string
          enum: [low, medium, high, critical]
        violation_description:
          type: string
          maxLength: 1000
        violation_details:
          type: object
        involved_members:
          type: array
          items:
            type: string
            format: uuid
        supporting_evidence:
          type: array
          items:
            type: string
        reporter_id:
          type: string
          format: uuid
      required:
        - policy_id
        - violation_type
        - violation_severity
        - violation_description

    # Supporting schemas
    PolicyEnforcementStatus:
      type: object
      properties:
        enforcement_level:
          type: string
          enum: [strict, moderate, lenient, monitoring_only]
        active_policies:
          type: integer
        enforcement_actions:
          type: integer
        compliance_score:
          type: number
          minimum: 0
          maximum: 100
        last_enforcement_action:
          type: string
          format: date-time

    ComplianceReport:
      type: object
      properties:
        report_id:
          type: string
          format: uuid
        report_period:
          type: object
        overall_compliance_score:
          type: number
          minimum: 0
          maximum: 100
        policy_compliance_breakdown:
          type: object
        violation_summary:
          type: object
        compliance_trends:
          type: object
        recommendations:
          type: array
          items:
            type: string

    # Error schemas
    ErrorResponse:
      type: object
      properties:
        error:
          type: object
          properties:
            code:
              type: string
            message:
              type: string
            details:
              type: object
            trace_id:
              type: string
          required:
            - code
            - message
      required:
        - error

  responses:
    BadRequestError:
      description: Invalid request parameters or policy enforcement operation
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

    ForbiddenError:
      description: Insufficient administrative permissions or policy violation
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

    InternalServerError:
      description: Internal server error in policy enforcement processing
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

tags:
  - name: Access Control
    description: |
      Access control policy management with permission enforcement and security boundary administration.

      **Access Control Administration**: Comprehensive access control policy configuration and enforcement management.

  - name: Privacy Policies
    description: |
      Privacy policy management with data protection rules and compliance enforcement.

      **Privacy Administration**: Complete privacy policy configuration with data protection and compliance management.

  - name: Security Policies
    description: |
      Security policy management with threat protection and security control enforcement.

      **Security Administration**: Comprehensive security policy configuration and threat protection management.

  - name: Policy Enforcement
    description: |
      Policy enforcement management with enforcement actions and compliance restoration.

      **Enforcement Administration**: Complete policy enforcement with compliance monitoring and violation remediation.

  - name: Policy Violations
    description: |
      Policy violation management with violation tracking, investigation, and remediation.

      **Violation Administration**: Comprehensive violation management with investigation and remediation capabilities.

  - name: Compliance Monitoring
    description: |
      Compliance monitoring with reporting, assessment, and improvement recommendations.

      **Compliance Administration**: Complete compliance monitoring with governance oversight and improvement strategies.

  - name: Policy Audit
    description: |
      Policy audit trail management with governance tracking and compliance auditing.

      **Audit Administration**: Comprehensive audit trail management with governance insights and compliance tracking.
